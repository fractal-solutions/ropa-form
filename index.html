<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records of Processing Activities</title>
    <style>

        /* Animation for appearing */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Animation for disappearing */
        @keyframes fadeOutDown {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        body {
            font-family: "Lucida Grande", "Lucida Sans Unicode", sans-serif;
            background: linear-gradient(to bottom, #3b5998, #192f60);
            color: #ffffff;
            text-align: center;
            padding: 20px;
            zoom: 0.65;
        }

        .container {
            max-width: 600px;
            min-height: 700px;
            margin: 0 auto;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            position: relative;
            background: linear-gradient(135deg, #2c3e50, #34495e); /* Gradient background */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Soft shadow for depth */
        }

        .tableContainer {
            display: none;
            margin: 0 auto;
            padding: 0px;
            padding-top: 20px;
            background: linear-gradient(135deg, #2c3e50, #34495e); /* Gradient background */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Soft shadow for depth */
            border-radius: 15px;
            position: relative;
        }

        h2 {
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-segment {
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
            display: none;
        }

        .form-segment.active {
            display: block;
        }

        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 1em;
            color: #ecf0f1;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 90%;
            padding: 10px;
            font-size: 1em;
            border-radius: 10px;
            border: 1px solid #7f8c8d;
            background: #34495e;
            color: #ecf0f1;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .input-group textarea {
            height: 100px;
            resize: vertical;
        }

        .checkbox-item {
            display: flex;
            align-items: center; /* Aligns checkbox and label vertically */
        }

        .checkbox-item input[type="checkbox"] {
            transform: scale(0.8); /* Adjust the scale value as needed */
            margin-right: 10px; /* Optional: add some space between checkbox and label */
            width: auto; /* Ensure that the checkbox doesn't get affected by parent width */
        }

        .warning::placeholder{
            color:#ff0000;
            
        }

        .warning::disabled {
            background-color: #5b0000d3;
        }


        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            position: absolute;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center; /* Center the buttons horizontally */
            gap: 200px; 
            bottom: 10px;
        }

        .navigation button {
            padding: 10px 20px;
            font-size: 1em;
            color: #ffffff;
            background: linear-gradient(to bottom, #2980b9, #1c598a);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        }

        .navigation button:hover {
            background: linear-gradient(to bottom, #1c598a, #143d63); /* Darker on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Larger shadow on hover */
        }

        .navigation button:active {
            transform: scale(0.95); /* Slightly shrink on click */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Smaller shadow on click */
        }

        .navigation button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
        }



        /* Container for the progress bar */
        .progress-bar {
            width: 100%;
            background: #ecf0f1;
            border-radius: 20px; /* Rounded corners */
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow effect for depth */
        }

        /* Fill progress */
        .progress {
            height: 10px; /* Slightly thicker */
            background: linear-gradient(45deg, #3498db, #2ecc71); /* Gradient background */
            border-radius: 20px; /* Match border radius with container */
            transition: width 0.5s ease-in-out; /* Smooth transition for width change */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2); /* Inner shadow for depth */
        }

        .wrapper {
            display: flex;
            min-height: 100vh; 
        }

        .sidebar {
            width: 250px; /* Slightly wider for more space */
            height: 100vh;
            background: linear-gradient(135deg, #2c3e50, #34495e); /* Gradient background */
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Soft shadow for depth */
            border-radius: 8px; /* Rounded corners */
            flex-shrink: 0;
            transition: all 0.3s ease; /* Smooth transition for hover effects */
            overflow-y: auto;

            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 10px;
        }

        .sidebar ul li a {
            color: #ecf0f1;
            text-decoration: none;
            font-size: 1.2em;
            display: block;
            padding: 10px;
            border-radius: 5px;
            background: linear-gradient(to bottom, #2980b9, #1c598a);
            text-align: center;
            transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .sidebar ul li a:hover {
            background: linear-gradient(to bottom, #1c598a, #143d63); /* Darker on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
            transform: translateX(5px); /* Slide effect on hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Larger shadow on hover */
        }

        .sidebar ul li a:active {
            transform: scale(0.95); /* Slightly shrink on click */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Smaller shadow on click */
            font-weight: bold;
        }

        /* Footer styling */
        .sidebar-footer {
            margin-top: auto; /* Pushes the footer to the bottom */
            text-align: center;
            padding: 10px;
        }

        /* Engraved text styling */
        .sidebar .engraved-text {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.99em;
            color: #151515;
            text-align: center;
            margin: 10px 0;
            position: absolute;
            bottom: 20px;
            width: 80%;
            text-shadow: 
                1px 1px 2px rgba(139, 139, 139, 0.1),
                -1px -1px 2px rgba(139, 139, 139, 0.1),
                1px -1px 2px rgba(149, 149, 149, 0.1),
                -1px 1px 2px rgba(139, 139, 139, 0.1);
        }


        .content {
            flex-grow: 1;
            padding: 20px;
        }



        table {
            width: 100%;
            border-collapse: collapse;
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }

        thead {
            background: #34495e;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #7f8c8d;
        }

        th {
            font-weight: bold;
            text-transform: uppercase;
        }

        tbody tr:hover {
            background: #3b5998;
        }

        .hide-column {
            display: none;
        }


        /* Modal styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black background with opacity */
        }

        .modal ::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari, and Opera */
        }

        .modal-content {
            background: linear-gradient(135deg, #2c3e50, #34495e); /* Gradient background */
            margin: 3% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
            border-radius: 8px; /* Rounded corners */
            max-height: 80%;
            overflow-y: auto;
        }

        .modal button {
            padding: 10px 20px;
            font-size: 1em;
            color: #ffffff;
            background: linear-gradient(to bottom, #2980b9, #1c598a);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        }

        .modal button:hover {
            background: linear-gradient(to bottom, #1c598a, #143d63); /* Darker on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Larger shadow on hover */
        }

        .modal button:active {
            transform: scale(0.95); /* Slightly shrink on click */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Smaller shadow on click */
        }

        .modal button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
        }

        .modal label {
            display: block;
            margin-bottom: 5px;
            font-size: 1em;
            color: #ecf0f1;
        }

        /* Style for the fieldsets */
        .modal-content fieldset {
            display: inline-block; /* Make fieldsets inline */
            width: 40%; /* Width of each fieldset */
            margin-right: 2%; /* Space between fieldsets */
            margin-bottom: 20px; /* Space below each fieldset */
            padding: 15px; /* Padding inside each fieldset */
            border: 2px solid #ecf0f1; /* Border color and thickness */
            border-radius: 10px; /* Rounded corners */
            box-sizing: border-box; /* Include padding and border in element's width and height */
            vertical-align: top; /* Align the top of each fieldset */
        }

        /* Ensure all fieldsets have the same height */
        .modal-content fieldset {
            height: auto; /* Default height */
            min-height: 200px; /* Minimum height for consistency */
        }

        /* Make sure all fieldsets in the same row have the same height */
        .modal-content fieldset:nth-child(2n-1) {
            clear: left; /* Clear floats for alignment */
        }

        /* Remove margin-right for the last fieldset in the row */
        .modal-content fieldset:nth-child(2n) {
            margin-right: 0;
        }

        /* Adjust the modal body for better alignment */
        #modalBody {
            display: flex;
            flex-wrap: wrap; /* Wrap fieldsets to the next row */
            gap: 10px; /* Space between fieldsets */
            justify-content: space-between; /* Space them out evenly */
        }

        /* Style for the legend */
        .modal-content legend {
            font-weight: bold; /* Make the legend text bold */
            padding: 0 10px; /* Add padding to the legend text */
            color: #2980b9; /* Legend text color */
        }

        .modal input,
        .modal select,
        .modal textarea {
            width: 90%;
            padding: 10px;
            font-size: 1em;
            border-radius: 10px;
            border: 1px solid #7f8c8d;
            background: #34495e;
            color: #ecf0f1;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
        }

        /* Modal Footer */
        .modal-footer {
            text-align: center;
            margin-top: 20px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* Stakeholder tabs style */
        .stakeholder-tabs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            display: flex;
        }

        .tab-link {
            background-color: #2c3e50;
            color: #ecf0f1;
            border: 1px solid #34495e;
            border-bottom: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            flex: 1; /* Equal width for each tab */
            text-align: center;
            font-size: 1.1em;
            border-radius: 8px 8px 0 0; /* Rounded top corners */
        }

        .tab-link:hover {
            background-color: #1c598a;
        }

        .tab-link.active {
            background-color: #ecf0f1;
            color: #2c3e50;
            border-color: #ecf0f1 #ecf0f1 #ffffff;
        }

        /* Style the tab content */
        .tab-content {
            display: none;
            padding: 20px;
            border: 0.5px solid #ecf0f1;
            border-radius: 0 8px 8px 8px;
            /* background-color: #ffffff; */
        }

        .tab-content.active {
            display: block;
        }

        /**/
        /* Accordion Styles */
        .accordion {
        background-color: #2980b9;
        color: white;
        cursor: pointer;
        padding: 12px;
        width: 100%;
        text-align: left;
        border: none;
        outline: none;
        transition: background-color 0.3s ease;
        margin-bottom: 5px;
        font-weight: bold;
        border-radius: 4px;
        }

        .accordion:hover {
        background-color: #3498db;
        }

        .accordion-button {
        width: 100%;
        background: none;
        border: none;
        color: inherit;
        cursor: pointer;
        text-align: left;
        padding: 12px 0;
        }

        .accordion-content {
        padding: 10px;
        background-color: #ecf0f1;
        display: none;
        border: 1px solid #ccc;
        border-top: none;
        border-radius: 0 0 4px 4px;
        }

        .accordion-content label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        }

        .accordion-content input[type="text"] {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        margin-bottom: 10px;
        }

        /* Active Accordion Content */
        .accordion-content.active {
        display: block;
        }

        /* Accordion Button Styles */
        .accordion-button {
        background-color: inherit;
        border: none;
        font-size: 16px;
        padding: 12px;
        text-align: left;
        color: #fff;
        width: 100%;
        }

        .accordion-button:hover {
        background-color: #3498db;
        }


        


    </style>
</head>
<body>
    <div class="wrapper">
        <nav class="sidebar">
            <ul>
                <li><a href="#" onclick="showForm()">New Record</a></li>
                <li><a href="#" onclick="showTable()">RoPA Entries</a></li>
            </ul>
            <div class="sidebar-footer">
                <p class="engraved-text">Fractal â„¢</p>
            </div>
        </nav>
        <main class="content">
            <!-- ROPA FORM-->
            <div class="container">
                <h2>Record of Processing Activities</h2>
                <div class="progress-bar">
                    <div class="progress"></div>
                </div>
                <form id="ropaForm">
                    
                    <!-- Segment 1 -->
                    <div class="form-segment active">
                        <div class="input-group">
                            <label for="processingActivity">Processing Activity</label>
                            <textarea id="processingActivity" name="processingActivity" placeholder="What processing activity are we undertaking on the data? A processing activity is any action or series of actions performed on data, especially personal data.  This definition is meant to be broad and encompass pretty much anything you can do with data. Because this is a ROPA, Assess each processing activity separately..." required></textarea>
                        </div>
                        <div class="input-group">
                            <label for="sourceReceivedFrom">Source Received from</label>
                            <input type="text" id="sourceReceivedFrom" name="sourceReceivedFrom" placeholder="Where did you source this data from?" required>
                        </div>
                        <div class="input-group">
                            <label for="data">Data</label>
                            <input type="text" id="data" name="data" placeholder="What data are you dealing with?" required>
                        </div>
                    </div>

                    <!-- Segment 2 -->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="purpose">Purpose</label>
                            <textarea id="purpose" name="purpose" placeholder="Why are you dealing with this data? E.g we need to provided medical care or we need to process employment applications" required></textarea>
                        </div>
                        <div class="input-group">
                            <label for="sharedWith">Shared with</label>
                            <input type="text" id="sharedWith" name="sharedWith" placeholder="Who are you sharing this information with?" required>
                        </div>
                        <div class="input-group">
                            <label for="dataSubject">Data Subject</label>
                            <input type="text" id="dataSubject" name="dataSubject" placeholder="Whose data is this?" required>
                        </div>
                    </div>

                    <!-- Segment 3 -->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="typeOfRecord">TYPE OF RECORD</label>
                            <input type="text" id="typeOfRecord" name="typeOfRecord" placeholder="What type of record is it?" required>
                        </div>
                        <div class="input-group">
                            <label for="dataClassification">Data Classification</label>
                            <input type="text" id="dataClassification" name="dataClassification" placeholder="What is the classification of this data?" required>
                        </div>
                        <div class="input-group">
                            <label for="sensitiveData">Sensitive Data</label>
                            <select id="sensitiveData" name="sensitiveData" required>
                                <option value="" disabled selected>Select an option</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>

                    <!-- Segment 4 -->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="gchControllerProcessor">GCH is controller or processor?</label>
                            <select id="gchControllerProcessor" name="gchControllerProcessor" required>
                                <option value="" disabled selected>Select an option</option>
                                <option value="controller">Controller</option>
                                <option value="processor">Processor</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="thirdPartyControllerProcessor">Third Party is controller or processor?</label>
                            <select id="thirdPartyControllerProcessor" name="thirdPartyControllerProcessor" required>
                                <option value="" disabled selected>Select an option</option>
                                <option value="controller">Controller</option>
                                <option value="processor">Processor</option>
                            </select>
                        </div>
                        
                        
                    </div>

                    <!-- Segment 5 -->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="basisOfProcessing">Basis of Processing</label>
                            <select id="basisOfProcessing" name="basisOfProcessing" required>
                                <option value="" disabled selected>Select an option</option>
                                <option value="consent">Consent</option>
                                <option value="contract">Contract</option>
                                <option value="legal-obligation">Legal obligation compliance</option>
                                <option value="vital-interests">Protection of vital interests</option>
                                <option value="public-interest-task">Task in public interest</option>
                                <option value="public-authority-task">Task by public authority</option>
                                <option value="public-function">Public function</option>
                                <option value="legitimate-interests">Legitimate interests</option>
                                <option value="research">Research, statistics, journalism, literature</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="justificationOfBasis">Justification of basis</label>
                            <textarea id="justificationOfBasis" name="justificationOfBasis" placeholder="Why did you select the basis - what is proof of the basis?" required></textarea>
                        </div>
                        <div class="input-group">
                            <label for="legitimateInterest">LEGITIMATE INTEREST</label>
                            <textarea id="legitimateInterest" name="legitimateInterest" placeholder="If the basis selected is legitimate interest, document in detail." required></textarea>
                        </div>
                    </div>


                    <!-- Segment X-->
                    

                    <!-- Segment 6 -->
                    <div class="form-segment">
                        
                        <div class="input-group">
                            <label for="impactOfProcessing">Impact of processing</label>
                            <textarea id="impactOfProcessing" name="impactOfProcessing" placeholder="Have we done DPIA?" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="automatedDecisionMaking">Existence of automated decision-making, including profiling (if applicable)</label>
                            <select id="automatedDecisionMaking" name="automatedDecisionMaking" required>
                                <option value="" disabled selected>Select an option</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>

                    </div>

                    <!-- Segment 7 -->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="transfer">TRANSFER</label>
                            <textarea id="transfer" name="transfer" placeholder="Is there a transfer of the data involved?" required></textarea>
                        </div>
                        <div class="input-group">
                            <label for="transferMechanism">TRANSFER MECHANISM</label>
                            <textarea id="transferMechanism" name="transferMechanism" placeholder="How is data transfer undertaken?" required></textarea>
                        </div>
                        <div class="input-group">
                            <label for="storage">Storage</label>
                            <textarea id="storage" name="storage" placeholder="How long will the data be stored?" required></textarea>
                        </div>
                    </div>

                    <!-- SEGMENT 8-->
                    <div class="form-segment">
                        <div class="input-group">
                            <label for="transfer">YOU HAVE NOT COMPLETED REQUIRED VALUES FOR THE ROPA</label>
                            <input class="warning" type="text" placeholder="Go back through the form and fill relevant data!" readonly required></textarea>
                        </div>
                    </div>


                    <div class="navigation">
                        <button type="button" id="prevBtn" onclick="changeSegment(-1)" disabled>Previous</button>
                        <button type="button" id="nextBtn" onclick="changeSegment(1)">Next</button>
                    </div>
                </form>
            </div>

            <!-- Table to display submitted entries -->
            <div class="tableContainer">
                <h2>Submitted Entries</h2>
                <table id="entriesTable">
                    <thead>
                        <tr>
                            <th>Processing Activity</th>
                            <th>Source Received From</th>
                            <th>Data</th>
                            <th>Purpose</th>
                            <th>Shared With</th>
                            <th>Data Subject</th>
                            <th>Type of Record</th>
                            <th>Data Classification</th>
                            <th>Sensitive Data</th>
                            <th>GCH</th>
                            <th>Third-Party</th>
                            <th>Basis of Processing</th>
                            <th class="hide-column">Justification of Basis</th>
                            <th class="hide-column">Legitimate Interest</th>
                            <th class="hide-column">Impact of Processing</th>
                            <th class="hide-column">Automated Decision-Making</th>
                            <th class="hide-column">Transfer</th>
                            <th class="hide-column">Transfer Mechanism</th>
                            <th>Storage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Entries will be dynamically added here -->
                    </tbody>
                </table>
            </div>

            <!-- Modal -->
            <div id="ropaModal" class="modal">
                <div class="modal-content" id="modalBody">
                    <span class="close">&times;</span>
                    <h2>ROPA Entry Details</h2>
                    
                </div>
            </div>
            
            <template id="ropaModalTemplate">
                <form id="modalRopaForm">
                    <!-- Processing Operation Section -->
                    <fieldset>
                        <legend>Processing Operation</legend>
                        <label for="processingDescription">Description of the processing operation:</label>
                        <textarea id="processingDescription" name="processingDescription"></textarea>
        
                        <label for="processingName">Name of the processing operation:</label>
                        <input type="text" id="processingName" name="processingName">
        
                        <label for="processingRef">ROPA Processing List REF:</label>
                        <input type="text" id="processingRef" name="processingRef">
        
                        <label for="creationDate">Date of creation of the processing:</label>
                        <input type="date" id="creationDate" name="creationDate">
        
                        <label for="updateDate">Update of the processing:</label>
                        <input type="date" id="updateDate" name="updateDate">
                    </fieldset>
        
                    <!-- Stakeholders Section -->
                    <fieldset>
                        <legend>Stakeholders</legend>
                    
                        <!-- Tabbed interface for stakeholders -->
                        <div class="stakeholder-tabs">
                            <button type="button" class="tab-link active" onclick="openStakeholderTab(event, 'controller')">Controller</button>
                            <button type="button" class="tab-link" onclick="openStakeholderTab(event, 'dpo')">Data Protection Officer (DPO)</button>
                            <button type="button" class="tab-link" onclick="openStakeholderTab(event, 'representative')">Representative</button>
                        </div>
                    
                        <!-- Stakeholder content sections -->
                        <div id="controller" class="tab-content active">
                            <label for="controllerName">Controller Name:</label>
                            <input type="text" id="controllerName" name="controllerName">
                    
                            <label for="controllerAddress">Controller Address:</label>
                            <input type="text" id="controllerAddress" name="controllerAddress">
                    
                            <label for="controllerPhone">Phone number:</label>
                            <input type="text" id="controllerPhone" name="controllerPhone">
                    
                            <label for="controllerEmail">Email address:</label>
                            <input type="email" id="controllerEmail" name="controllerEmail">
                        </div>
                    
                        <div id="dpo" class="tab-content">
                            <label for="dpoName">DPO Name:</label>
                            <input type="text" id="dpoName" name="dpoName">
                    
                            <label for="dpoAddress">DPO Address:</label>
                            <input type="text" id="dpoAddress" name="dpoAddress">
                    
                            <label for="dpoPhone">Phone number:</label>
                            <input type="text" id="dpoPhone" name="dpoPhone">
                    
                            <label for="dpoEmail">Email address:</label>
                            <input type="email" id="dpoEmail" name="dpoEmail">
                        </div>
                    
                        <div id="representative" class="tab-content">
                            <label for="repName">Representative Name:</label>
                            <input type="text" id="repName" name="repName">
                    
                            <label for="repAddress">Representative Address:</label>
                            <input type="text" id="repAddress" name="repAddress">
                    
                            <label for="repPhone">Phone number:</label>
                            <input type="text" id="repPhone" name="repPhone">
                    
                            <label for="repEmail">Email address:</label>
                            <input type="email" id="repEmail" name="repEmail">
                        </div>
                    </fieldset>
                    
                    
        
                    <!-- Purpose Section -->
                    <fieldset>
                        <legend>Other Purpose(s) of the Data Processing</legend>
        
                        <label for="subPurpose1">Sub-purpose 1:</label>
                        <input type="text" id="subPurpose1" name="subPurpose1">
        
                        <label for="subPurpose2">Sub-purpose 2:</label>
                        <input type="text" id="subPurpose2" name="subPurpose2">

                        <label for="subPurpose3">Sub-purpose 3:</label>
                        <input type="text" id="subPurpose3" name="subPurpose3">

                        <label for="subPurpose4">Sub-purpose 4:</label>
                        <input type="text" id="subPurpose4" name="subPurpose4">

                        <label for="subPurpose5">Sub-purpose 5:</label>
                        <input type="text" id="subPurpose5" name="subPurpose5">
        
                        <!-- Add additional sub-purpose fields as needed -->
                    </fieldset>

        
                    <!-- Categories of Personal Data Section -->
                    <fieldset>
                        <legend>Categories of Personal Data</legend>
                        <!-- Tabs -->
                        <div class="tabs">
                            <button class="tab-link" onclick="openTab('categoriesData')">Categories of Personal Data</button>
                            <button class="tab-link" onclick="openTab('specialCategoriesData')">Special Categories of Personal Data</button>
                        </div>

                        <!-- Tab Content -->
                        <div id="categoriesData" class="categories-tab-content">
                            <!-- Accordion for Categories of Personal Data -->
                            <div class="accordion">
                            <button class="accordion-button">Marital status, ID, identification data, images...</button>
                            <div class="accordion-content">
                                <label>Description:</label>
                                <input type="text" name="description_marital_status">
                                <label>Data retention period:</label>
                                <input type="text" name="retention_period_marital_status">
                            </div>
                            </div>
                            
                            <div class="accordion">
                            <button class="accordion-button">Children's Data</button>
                            <div class="accordion-content">
                                <label>Description:</label>
                                <input type="text" name="description_children_data">
                                <label>Data retention period:</label>
                                <input type="text" name="retention_period_children_data">
                            </div>
                            </div>
                            
                            <!-- Add more accordions as needed -->
                        </div>

                        <div id="specialCategoriesData" class="categories-tab-content">
                            <!-- Accordion for Special Categories of Personal Data -->
                            <div class="accordion">
                            <button class="accordion-button">Data revealing ethnic origin</button>
                            <div class="accordion-content">
                                <label>Description/Context:</label>
                                <input type="text" name="description_ethnic_origin">
                                <label>Data retention period:</label>
                                <input type="text" name="retention_period_ethnic_origin">
                            </div>
                            </div>
                            
                            <div class="accordion">
                            <button class="accordion-button">Data revealing health status</button>
                            <div class="accordion-content">
                                <label>Description/Context:</label>
                                <input type="text" name="description_health_status">
                                <label>Data retention period:</label>
                                <input type="text" name="retention_period_health_status">
                            </div>
                            </div>
                            
                            <!-- Add more accordions as needed -->
                        </div>
                    </fieldset>
        
                    <!-- Recipients Section -->
                    <fieldset>
                        <legend>Recipients</legend>
                        <label for="recipient1">Recipient 1:</label>
                        <input type="text" id="recipient1" name="recipient1">
        
                        <label for="recipientDetails1">Details:</label>
                        <textarea id="recipientDetails1" name="recipientDetails1"></textarea>
        
                        <!-- Add similar fields for other recipients -->
                    </fieldset>
        
                    <!-- Security Measures Section -->
                    <fieldset>
                        <legend>Security Measures</legend>
                        <label for="securityMeasure1">Type of security measure:</label>
                        <input type="text" id="securityMeasure1" name="securityMeasure1">
        
                        <label for="securityDetails1">Details:</label>
                        <textarea id="securityDetails1" name="securityDetails1"></textarea>
        
                        <!-- Add similar fields for other security measures -->
                    </fieldset>
        
                    <!-- Transfers to Third Countries Section -->
                    <fieldset>
                        <legend>Transfers to Third Countries or International Organisations</legend>
                        <label for="recipientOrg1">Recipient organisation 1:</label>
                        <input type="text" id="recipientOrg1" name="recipientOrg1">
        
                        <label for="recipientCountry1">Country:</label>
                        <input type="text" id="recipientCountry1" name="recipientCountry1">
        
                        <label for="typeOfGuarantees">Type of guarantees:</label>
                        <input type="text" id="typeOfGuarantees" name="typeOfGuarantees">
        
                        <label for="relevantDocuments">Links to relevant documents:</label>
                        <input type="url" id="relevantDocuments" name="relevantDocuments">
        
                        <!-- Add similar fields for other recipient organisations -->
                    </fieldset>
        
                    <!-- Submit and Close buttons -->
                    <div class="modal-footer">
                        <button type="submit">Save</button>
                        <button type="button" class="close-btn">Close</button>
                    </div>
                </form>
            </template>

            <script>
                let currentSegment = 0;
                const segments = document.querySelectorAll('.form-segment');
                const progress = document.querySelector('.progress');
                const prevBtn = document.querySelector('#prevBtn');
                const nextBtn = document.querySelector('#nextBtn');
            
                function showSegment(n) {
                    // Hide the current segment
                    segments[currentSegment].classList.remove('active');
                    
                    // Move to the next/previous segment
                    currentSegment += n;
                    
                    // Check if the segment is out of bounds
                    if (currentSegment >= segments.length) {
                        currentSegment = segments.length - 1;
                    }
                    if (currentSegment < 0) {
                        currentSegment = 0;
                    }

                    // Show the new segment
                    segments[currentSegment].classList.add('active');

                    // Update buttons and progress
                    updateButtons();
                    updateProgress();

                    // If on the last segment and moving forward, submit the form
                    if (currentSegment === segments.length - 1 && n === 1) {
                        //document.getElementById("ropaForm").submit(); // Trigger the form submission
                    }
                }

            
                function changeSegment(n) {
                    showSegment(n);
                }
            
                function updateButtons() {
                    prevBtn.disabled = currentSegment === 0;
                    nextBtn.textContent = currentSegment >= (segments.length - 2) ? 'Submit' : 'Next';
                    currentSegment === (segments.length - 1) ? nextBtn.type = 'submit' : nextBtn.type = 'button';
                    currentSegment > (segments.length - 1) ? nextBtn.disabled = true : nextBtn.disabled = false;
                }
            
                function updateProgress() {
                    const percentComplete = ((currentSegment + 1) / segments.length) * 100;
                    progress.style.width = percentComplete + '%';
                }
            
                // Initial setup
                updateButtons();
                updateProgress();
            
                function showForm() {
                    document.querySelector('.container').style.display = 'block';
                    document.querySelector('.tableContainer').style.display = 'none';
                }
            
                function showTable() {
                    document.querySelector('.container').style.display = 'none';
                    document.querySelector('.tableContainer').style.display = 'block';
                    displayEntries();
                }
            
                // Store form data in localStorage (you can use a database in a real app)
                document.getElementById('ropaForm').onsubmit = function (e) {
                    e.preventDefault();
                    const formData = new FormData(this);
                    const entries = JSON.parse(localStorage.getItem('entries')) || [];
                    const entry = {};
            
                    formData.forEach((value, key) => {
                        entry[key] = value;
                    });
            
                    entries.push(entry);
            
                    localStorage.setItem('entries', JSON.stringify(entries));
                    alert('Form submitted successfully!');
                    this.reset();
                    showTable();
                    segments[currentSegment].classList.remove('active');
                    currentSegment = 0;  // Reset to first segment
                    showSegment(currentSegment);
                    updateButtons();  // Update navigation buttons
                    updateProgress();  // Reset progress bar
                };
            
                // Display entries in the table
                function displayEntries() {
                    const entries = JSON.parse(localStorage.getItem('entries')) || [];
                    const tableBody = document.querySelector('#entriesTable tbody');
                    tableBody.innerHTML = '';
            
                    entries.forEach((entry) => {
                        const row = document.createElement('tr');
            
                        Object.keys(entry).forEach(key => {
                            const cell = document.createElement('td');
                            cell.textContent = entry[key];
                            row.appendChild(cell);
                        });
            
                        tableBody.appendChild(row);
                    });

                    hideColumns();
                }
                // Function to hide specific columns based on the index
                function hideColumns() {
                    var table = document.getElementById("entriesTable");
                    var hideIndices = [];

                    // Find the indices of the columns that should be hidden
                    var headerCells = table.rows[0].cells;
                    for (var i = 0; i < headerCells.length; i++) {
                    if (headerCells[i].classList.contains("hide-column")) {
                        hideIndices.push(i);
                    }
                    }

                    // Hide the header columns
                    for (var i = 0; i < hideIndices.length; i++) {
                    headerCells[hideIndices[i]].style.display = "none";
                    }

                    // Hide the corresponding columns in the body rows
                    for (var j = 1; j < table.rows.length; j++) { // Start from 1 to skip the header row
                    for (var k = 0; k < hideIndices.length; k++) {
                        table.rows[j].cells[hideIndices[k]].style.display = "none";
                    }
                    }
                }


                // Get modal and close button elements
                const modal = document.getElementById("ropaModal");
                const modalForm = document.getElementById("ropaModalTemplate");
                const closeBtn = document.querySelector(".close");

                // Function to open the modal and populate it with data
                function openModal(entryData) {
                    const modalBody = document.getElementById("modalBody");
                    // Clear previous content
                    modalBody.innerHTML = "";
                    
                    
                    // Populate modal with entry data
                    modalBody.innerHTML += `<p>Processing Activity: ${entryData.processingActivity}</p>`;
                    modalBody.innerHTML += `<p>Source Received from: ${entryData.sourceReceivedFrom}</p>`;
                    // Add other data fields as needed
                    const templateContent = modalForm.content.cloneNode(true);// Clone the template content
                    modalBody.appendChild(templateContent);// Append the cloned content to the modal body

                    // Display the modal
                    modal.style.display = "block";
                }

                // Event listener for table rows
                document.getElementById("entriesTable").addEventListener("click", function (event) {
                    if (event.target && event.target.nodeName === "TD") {
                        // Assuming the row contains the entry data
                        const row = event.target.parentNode;
                        const entryData = {
                            processingActivity: row.children[0].innerText,
                            sourceReceivedFrom: row.children[1].innerText
                            // Add other data fields as needed
                        };
                        openModal(entryData);
                    }
                });

                // Event listener for the close button
                closeBtn.onclick = function () {
                    modal.style.display = "none";
                }

                // Close the modal if the user clicks anywhere outside of the modal
                window.onclick = function (event) {
                    if (event.target === modal) {
                        modal.style.display = "none";
                    }
                }

                function openStakeholderTab(event, stakeholderId) {
                    // Hide all tab contents
                    const tabContents = document.querySelectorAll('.tab-content');
                    tabContents.forEach(tab => tab.classList.remove('active'));

                    // Remove active class from all tabs
                    const tabLinks = document.querySelectorAll('.tab-link');
                    tabLinks.forEach(tab => tab.classList.remove('active'));

                    // Show the current tab content
                    document.getElementById(stakeholderId).classList.add('active');

                    // Add active class to the clicked tab
                    event.currentTarget.classList.add('active');
                }

                function openTab(tabName) {
                    var i, tabcontent, tabbuttons;
                    tabcontent = document.getElementsByClassName("categories-tab-content");
                    for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                    }
                    tabbuttons = document.getElementsByClassName("tab-button");
                    for (i = 0; i < tabbuttons.length; i++) {
                    tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
                    }
                    document.getElementById(tabName).style.display = "block";
                    event.currentTarget.className += " active";
                }

                document.getElementsByClassName("tab-button")[0].click(); // Default to opening the first tab

                modal.addEventListener("shown.bs.modal", function () {
                    initializeAccordions();
                });

                

                function initializeAccordions() {
                    const accordions = document.querySelectorAll(".accordion");

                    accordions.forEach((accordion) => {
                        accordion.addEventListener("click", function () {
                        this.classList.toggle("active");
                        const content = this.nextElementSibling;
                        if (content.style.display === "block") {
                            content.style.display = "none";
                        } else {
                            content.style.display = "block";
                        }
                        });
                    });
                }



            </script>
            
        </main>
    </div>
</body>
</html>
